---
RESTful 接口设计
---

#### 目录

1. RESTful 接口的命名规范及语义格式
   1. 基于 HTTP 协议 URL 对外暴露
   2. 使用 XML 或 JSON 格式定义
   3. 根据不同行为使用不同的请求方式
2. RESTful 接口的设计规则和注意事项
   1. 接口要保证幂等性设计
   2. 标准化的结果响应集
   3. 接口设计采用无状态方案

#### RESTful 接口的命名规范及语义格式

RESTful API 有三个要点：

1. 基于 HTTP 协议 URL 对外暴露
2. 使用 XML 或 JSON 格式定义
3. 根据不同行为使用不同的请求方式

##### 基于 HTTP 协议 URL 对外暴露

在 RESTful 风格中，URL 被视为资源，要求使用名词进行说明，一般标准如下：

```apl
http(s)://域名:端口[/版本]/资源1[/子资源2/.../子资源n][/路径变量]
```

##### 使用 XML 或 JSON 格式定义

RESTful 接口要求返回的是 JSON 或 XML 数据，绝不可以包含任何与具体展现相关的内容。比如以下响应内容：

```json
{
    "code" : "0" ,
    "message" : "success" ,
    "data" : "<h1>员工姓名:张三</h1>..."
}
```

data 选项内容就是完全错误的，因为 h1 标签是 HTML 的内置标签，只有浏览器能够解析展现，如果客户端是 Android/iOS，那岂不是无法使用？所以 RESTful 接口返回的数据一定要与展现无关。可以改成类型下面的这种响应：

```json
{
    "code" : "0" ,
    "message" : "success" ,
    "data" : {
        "name":"张三",
        "age" : 36
    }
}
```

##### 根据不同行为，使用不同请求方式

在 RESTful 语义中最常用的 GET、POST、PUT、DELETE 请求方式都有明确的用途，不能乱用。

如果你的 RESTful 接口写的足够标准，其他工程师应该可以轻松的根据请求方式与 URL 的语义，猜出 RESTful 接口的作用，这也是 RESTful 风格的重要意义。

#### RESTful 接口的设计规则与注意事项

##### 接口要保证幂等性设计

在我们项目中，RESTful 接口设计的基本前提是保证幂等性。那什么是幂等性呢？就是多次重复请求时，接口能够保证与预期相符的结果。

##### 标准化的响应结果集

RESTful 响应的 JSON 结构应当全局保持相同的结构与语义，这里给出行业最常见的数据格式范例。

在标准化的响应结构中，要包含 code、message 两项，分别对应了服务器处理结果与返回的消息内容。除此之外，data 属性是可选项，包含从响应返回的额外数据，如查询结果、新增或更新后的数据。

在语义层面，也要遵循相同的规则。例如，当服务器处理成功，code 固定等于 0；如果遇到异常请求，公司内部也要遵循统一的 code 命名标准。例如：code 以 1xx 开头代表参数异常，2xx 开头代表数据库处理异常。

##### 接口设计采用无状态方案

无状态方案，顾名思义 RESTful 接口每一个请求访问进来，应能得到相同的预期。